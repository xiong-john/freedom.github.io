<html><head></head><body><h1 id="-">浏览器渲染顺序</h1>
<h2 id="-">渲染顺序图</h2>
<p><img src="http://coolshell.cn//wp-content/uploads/2013/05/Render-Process.jpg" alt="图片">
<img src="./../../source/imgs/stacking-order.jpg" alt=""></p>
<h2 id="-">说明</h2>
<h3 id="-">浏览器解析</h3>
<ul>
<li>html/xml…… --dom树</li>
<li>css -- css规则树</li>
<li>js -- 修改dom和css</li>
</ul>
<h3 id="-">解析完之后</h3>
<ul>
<li>浏览器根据 dom tree和css rule tree来构造render tree.</li>
<li>render tree和dom tree不太一样， 不用显示的dom元素不在此tree中， 比如head /display: hidden;的</li>
<li>Frame过程，css rule tree匹配render tree（绑定在一起， 一个dom可能被匹配了多个rule）</li>
<li>计算Frame的的位置， 又称layout/reflow</li>
</ul>
<h3 id="-native-gui-api">调用系统底层进行渲染 Native GUI的API</h3>
<h3 id="-">渲染过程</h3>
<ul>
<li>repaint 局部改变（）</li>
<li>Reflow 被改变了布局，整个render tree要重新计算。成本高.</li>
</ul>
<pre><code><div class="highlight"><pre><span class="err">当你增加、删除、修改</span><span class="nx">DOM</span><span class="err">结点时，会导致</span><span class="nx">Reflow</span><span class="err">或</span><span class="nx">Repaint</span>
<span class="err">当你移动</span><span class="nx">DOM</span><span class="err">的位置，或是搞个动画的时候。</span>
<span class="err">当你修改</span><span class="nx">CSS</span><span class="err">样式的时候。</span>
<span class="err">当你</span><span class="nx">Resize</span><span class="err">窗口的时候（移动端没有这个问题），或是滚动的时候。</span>
<span class="err">当你修改网页的默认字体</span>

<span class="err">注：</span> <span class="nx">display</span><span class="o">:</span><span class="nx">none</span><span class="err">会触发</span><span class="nx">reflow</span><span class="err">，而</span><span class="nx">visibility</span><span class="o">:</span><span class="nx">hidden</span><span class="err">只会触发</span><span class="nx">repaint</span><span class="err">，因为没有发现位置变化。</span>
</pre></div>

</code></pre><ul>
<li>减少reflow/repaint
```</li>
<li>不要一条一条地修改DOM的样式。与其这样，还不如预先定义好css的class，然后修改DOM的className。;</li>
<li>把DOM离线后修改(先hidden， 修改完之后再显示，这样只触发了两次reflow);</li>
<li>或者 clone一个DOM结点到内存里，然后想怎么改就怎么改，改完后，和在线的那个的交换一下;</li>
<li>不要把DOM结点的属性值放在一个循环里当成循环里的变量;</li>
<li>尽可能的修改层级比较低的DOM;</li>
<li>为动画的HTML元件使用fixed或absoult的position;</li>
<li>千万不要使用table布局;
```</li>
</ul>
</body></html>