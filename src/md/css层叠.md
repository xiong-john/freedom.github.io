# css 层叠和继承、特殊性

## 特殊性

关注的问题： 样式优先权的问题

每个选择器都有特殊性（specificity）
“对于每个规则，用户代理会计算选择器的特殊性，并将这个特殊性附加到规则中的各个声明。如果一个元素有两个或多个冲突的属性声明，那么有最高特殊性的声明就会胜出”

* 规则如下
	* 对于选择器中给定的各个ID属性值，加0，1，0，0
	* 对于选择器中给定的各个类属性值，属性选择或伪类，加0，0，1，0。
	* 对于选择器中给定的各个元素和伪元素，加0，0，0，1。伪元素是否有特殊性，在这方面css2有些自相矛盾，不过css2.1很清楚的指出，伪元素有特殊性，而且其特殊性为0，0，0，1。
	* 结合符和通配符选择器对特殊性没有任何贡献
	* “每个内联声明的特殊性都是1,0, 0,0”

	“标志为!important的声明并没有特殊的特殊性值，不过要与非重要声明分开考虑”。所有“!important”声明会分组在一起，重要声明的特殊性冲突会在重要声明内部解决，而不会与非重要声明相混。

* ID选择器 和 属性选择器
“第二个规则中的ID选择器（#answer）为选择器的总特殊性贡献了0,1, 0,0。而在第一个规则中，属性选择器（[id="totals"]）只对总特殊性贡献了0,0,1,0”

## 继承

继承的值没有特殊性。连0都没有。 通配符*有0的特殊性，所以要高于继承。（通配符可以做成短路继承）

* 向上传播， 应用到body元素的背景样式可以传递到html。

不能继承的声明：外边距，内边距，背景，边框。


## 层叠样式表
css所给予的方法就是让样式层叠在一起。这是通过结合继承和特殊性做到的。
2.1的层叠规则：找出所有相关的规则，这些规则都包含与一个给定元素匹配的选择器。

* 按显示权重对应用到该元素的所有声明排序。 标志important的规则的权重要高于没有的。按来源对应用到给定元素的所有声明排序。

* 按来源对应用到给定元素的所有声明排序。
共有三种来源： 创作人员、读者和用户代理。 
	* 创作人员 —— 开发者；
	* 用户代理 —— （agent’s style）浏览器默认；
	* 读者样式 —— 网页浏览者通过浏览器修改的样式；
`
1.创作人员的样式 > 读者人员的样式 > 用户代理的默认样式
2.标记为重要声明（!important）的读者样式 > 一切样式
`

* 按特殊性对应用到给定元素的所有声明排序。有较高特殊性的元素权重要大于有较低特殊性的元素。

* 按出现顺序对应用到给定元素的所有声明排序。一个声明在样式表或文档中越后出现它的权重就越大。





### 例

```
<style>
  
  .test1 {
  	color:black;
  }
  .test1 #test{
    color:green;
  }

  

</style>

<div id="test" class="test1">
  <div id="test" class="test1">
    color;
  </div>
</div>
```

* 解析：
`.test1 #test`的权重为（0, 1, 1, 0），而.test1 的权重为（0, 0, 1, 0）;相比之下应该是`.test1 #test`更有分量。此处显示颜色为绿色（green）

* 加上样式
```
#test .test1{
    color:red;
  }
```
	* `.test1 #test` 与 `#test .test1`。  
	`.test1 #test`的权重为（0, 1, 1, 0）,  `#test .test1`权重也为（0, 1, 1, 0）。两者一样。所以根据层叠样式`一个声明在样式表或文档中越后出现它的权重就越大`。 所以该出应该是`#test .test1`的样式胜出。颜色为红色。


* 如果加上
```
* {
  color:yellow !important;
}
```

 	* 通配符下的`important`即使通配符没有特殊性。但是important为重要声明，所以在此应该是最高的。颜色为黄色（yellow）。

* 如果再加上
```
#test{
  color: blue!important;
}
```
	* 在重要声明中继续比较层叠样式。 `#test`的权重明显高于通配符。所以此处显示为蓝色（blue）。
